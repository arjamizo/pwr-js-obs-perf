<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ember's test</title>
    <script src="../bower_components/jquery/dist/jquery.js"></script>
    <script src="../bower_components/ember/ember.js"></script>
    <script src="../bower_components/ember/ember-template-compiler.js"></script>
</head>
<body>
    <script>
        window.addEventListener("load", function() {
            var argument = location.hash.substr(1) * 1;
            document.title = "Ember's test - expected "+argument+"ms";
            document.body.start=window.performance.now();
            console.log("start", document.body.start)
            setTimeout(function () {
                document.body.end = window.performance.now()
                console.log("stop", document.body.end)
            }, argument);
        })

        var Todos = Ember.Application.create({
        });

        /** Router **/
        Todos.Router.map(function () {
            this.resource('todos', {path: "/"}, function() {
                this.route('todo', {path: "/todo/:todo_id"});
            });
        });

        Todos.TodosRoute = Ember.Route.extend({
            model: function() {
                return this.get('todos');
            }
        });

        Todos.TodosTodoRoute = Ember.Route.extend({
            model: function(todo) {
                return this.get('todos')[todo.todo_id];
            }
        });

        Todos.Todo = Ember.Object.extend({"title": ""});

        Todos.TodosController = Ember.Controller.extend({ // Ember.ArrayController deprecated in Ember 2.0
            todos: [{title: "example"}],
            // needs: ['todos'], // self-reference, can be accessed via #each controllers.todos

            actions: {
                addTodo: function() {
                    var title = this.get('title');
                    console.log('el', title)
                    this.get('todos').pushObject(Todos.Todo.create({
                        "title": title
                    }));
                }
            }
        });
        
        // Todos.__container__.lookup('controller:todos').get('todos').push({title: "321"}) // accessing directly

    </script>
    <script type="text/x-handlebars" id="todos">
        {{input value=title}} <button {{action "addTodo"}}>add</button> {{title}}
        {{! todos replaces controller or controllers.todos in case of using `needs` }}
        <div class="list-group" style="margin-top: 10px;">
            {{#each todos as |todo|}}  
                <div class="list-group-item">
                    {{todo.title}}
                </div>
            {{/each}}
        </div>
    </script>
    <script type="text/x-handlebars" id="application">
        {{outlet}}
    </script>

</body>
</html>
